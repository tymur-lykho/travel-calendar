import{a as A,i as j}from"./assets/vendor-B_OA0gJ3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();const I={GM_API_KEY:"AIzaSyCRqbfD4tRFZ-38qw05HcOWlWRQqoPfjYY"};(e=>{var t,o,n,r="The Google Maps JavaScript API",a="google",s="importLibrary",d="__ib__",u=document,m=window;m=m[a]||(m[a]={});var p=m.maps||(m.maps={}),h=new Set,f=new URLSearchParams,N=()=>t||(t=new Promise(async(v,k)=>{await(o=u.createElement("script")),f.set("libraries",[...h]+"");for(n in e)f.set(n.replace(/[A-Z]/g,F=>"_"+F[0].toLowerCase()),e[n]);f.set("callback",a+".maps."+d),o.src=`https://maps.${a}apis.com/maps/api/js?`+f,p[d]=v,o.onerror=()=>t=k(Error(r+" could not load.")),o.nonce=u.querySelector("script[nonce]")?.nonce||"",u.head.append(o)}));p[s]?console.warn(r+" only loads once. Ignoring:",e):p[s]=(v,...k)=>h.add(v)&&N().then(()=>p[s](v,...k))})({key:I.GM_API_KEY,v:"weekly"});const c={mapArea:document.getElementById("map"),resizer:document.querySelector(".resizer"),randomBtn:document.getElementById("btn-random-place"),findMeBtn:document.getElementById("btn-my-coordinate"),addMarkerBtn:document.getElementById("btn-add-marker"),addLocationbtn:document.getElementById("btn-add-location"),addLocationForm:document.getElementById("add-location-form"),locationList:document.getElementById("location-list"),closeLocationListBtn:document.getElementById("btn-close-location-list"),createRouteForm:document.getElementById("create-route-form"),userRoutesList:document.getElementById("user-routes"),userRouteItemList:document.getElementById("user-route"),dialog:document.querySelector("dialog"),dialogCloseBtn:document.getElementById("dialog-close-btn"),dialogForm:document.getElementById("dialog-form")};function H(e){const r=Math.floor(e/86400),a=Math.floor(e%86400/3600),s=Math.floor(e%3600/60),d=e%60;return{days:r,hours:a,minutes:s,seconds:d}}function _(e){const n=Math.floor(e/1e6),r=Math.floor(e%1e6/1e3),a=e%1e3;return{kkms:n,kms:r,meters:a}}function R(e,t){return Math.random()*(t-e)+e}function C(e){return JSON.stringify(e)}function G(e){try{return JSON.parse(e)}catch(t){console.log("Parse error :",t)}}function b(e,t){localStorage.setItem(e,C(t))}function U(e){localStorage.removeItem(e)}function L(e){return G(localStorage.getItem(e))}const i={map:null,marker:null,infoWindow:null};let g=[];async function w(e,t,o,n=void 0,r=!0){const{AdvancedMarkerElement:a,PinElement:s}=await google.maps.importLibrary("marker");let d;if(n){const m=document.createElement("img");m.src=n,d=new s({glyph:m})}const u=new a({map:i.map,position:e,gmpDraggable:t,gmpClickable:!0,content:d?.element,title:o});return u.addListener("dragstart",()=>{i.infoWindow.close()}),r&&(u.addListener("dragend",()=>S(u)),u.addListener("gmp-click",()=>S(u))),console.log("Init Marker"),u}function $(e,t){e.position=t}function y(e,t,o=!1){const r=o?'<div class="loader"></div>':t;i.infoWindow.setContent(r),i.infoWindow.open(i.map,e)}function Z(){g=L("user-markers"),g&&g.forEach(t=>{w(t,!0,"User saved marker")});const e=L("user-location-marker");e&&(i.marker.position=e),console.log("Init SavedMarkers")}function Y(e){w(e,!0,"New User Marker"),g?g.push(e):g=[e],b("user-markers",g)}function z(e){c.locationList.innerHTML="";const t=e.map(({formatted_address:o,geometry:n})=>`<li class='location-item' data-location='${C(n.location)}' data-name='${o}'>
		<h3>${o}</h3>
		<p>Coordinates: ${n.location.lat}, ${n.location.lng}</p>
		</li>`).join("");c.locationList.insertAdjacentHTML("beforeend",t)}function P(e){c.userRoutesList.innerHTML="";const t=e.map(s=>`
			<h5>${s.title}</h5>
			<button id="open-route" data-routeid="${s.id}" type="button">Open Route</button>
			<button id="edit-route" data-routeid="${s.id}" type="button">Edit Route</button>
			<button id="delete-route" data-routeid="${s.id}" type="button">Delete Route</button>
			<ol
      class="user-route draggable-container"
      id="user-route"
      style="border: 1px solid red"
    >
		<li> 
			<h6>${s.route[0].place.title}</h6>
			<button type="button" id="show-route-point" data-pointid="${s.route[0].place.id}">Show this point</button>
		</li>
		</ol>`).join("");c.userRoutesList.insertAdjacentHTML("beforeend",t);const o=document.querySelectorAll("#open-route"),n=document.querySelectorAll("#edit-route"),r=document.querySelectorAll("#delete-route"),a=document.querySelectorAll("#show-route-point");o.forEach(s=>{s.addEventListener("click",me)}),n.forEach(s=>{s.addEventListener("click",pe)}),r.forEach(s=>{s.addEventListener("click",ge)}),a.forEach(s=>{s.addEventListener("click",fe)})}function K(e){const o=`
  	<label for="route-select">Оберіть маршрут:</label>
		<select id="route-select" name="route">
			${e.map(n=>`<option value="${n.id}">${n.title}</option>`).join("")}
		</select>

  	<button type="button" id="create-route-btn">Створити новий маршрут</button>

		<label for="point-title">Назва точки:</label>
		<input type="text" id="point-title" name="point-title" required />

		<label for="point-description">Опис точки:</label>
		<textarea id="point-description" name="point-description"></textarea>

  	<button type="submit">Додати точку</button>
	`;c.dialogForm.insertAdjacentHTML("beforeend",o),c.dialog.showModal()}let l=[];async function J(e,t){const o="https://routes.googleapis.com/directions/v2:computeRoutes",n={origin:{location:{latLng:{latitude:e.lat,longitude:e.lng}}},destination:{location:{latLng:{latitude:t.lat,longitude:t.lng}}},travelMode:"WALK",computeAlternativeRoutes:!1,routeModifiers:{avoidTolls:!1,avoidHighways:!1,avoidFerries:!1},languageCode:"en-US",units:"IMPERIAL"},r={headers:{"Content-Type":"application/json","X-Goog-Api-Key":I.GM_API_KEY,"X-Goog-FieldMask":"routes.duration,routes.distanceMeters,routes.polyline.encodedPolyline"}};try{return(await A.post(o,n,r)).data}catch(a){throw console.error("Помилка отримання маршруту:",a.response?.data||a.message),a}}async function X(e){await google.maps.importLibrary("geometry");const t=google.maps.geometry.encoding.decodePath(e);new google.maps.Polyline({path:t,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:4}).setMap(i.map)}function Q(e,t){const o=l.length!==0?l[l.length-1].id+1:0,n={place:{id:String(o)+"-"+String(0),title:"Start Point",coordinate:e},description:"You start your route on this point",pointNumber:0},r={id:o,title:t,route:[]};return r.route.push(n),l.push(r),b("user-routes",l),r}function V(e){let t;return l.length===1?(t=l[0],l=[],U("user-routes")):(t=l.splice(e,1),b("user-routes",l)),P(l),t}function ee(){l=L("user-routes")||[],P(l),console.log("Init User Routes")}function te(e){const t=l.find(n=>n.route.some(r=>r.place.id===e));return t?t.route.find(n=>n.place.id===e).place:null}const oe="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23e3e3e3'%3e%3cpath%20d='M560-160v-80h104L537-367l57-57%20126%20126v-102h80v240H560Zm-344%200-56-56%20504-504H560v-80h240v240h-80v-104L216-160Zm151-377L160-744l56-56%20207%20207-56%2056Z'/%3e%3c/svg%3e",ne="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23e3e3e3'%3e%3cpath%20d='M480-80q-83%200-156-31.5T197-197q-54-54-85.5-127T80-480q0-83%2031.5-156T197-763q54-54%20127-85.5T480-880q146%200%20255.5%2091.5T872-559h-82q-19-73-68.5-130.5T600-776v16q0%2033-23.5%2056.5T520-680h-80v80q0%2017-11.5%2028.5T400-560h-80v80h80v120h-40L168-552q-3%2018-5.5%2036t-2.5%2036q0%20131%2092%20225t228%2095v80Zm364-20L716-228q-21%2012-45%2020t-51%208q-75%200-127.5-52.5T440-380q0-75%2052.5-127.5T620-560q75%200%20127.5%2052.5T800-380q0%2027-8%2051t-20%2045l128%20128-56%2056ZM620-280q42%200%2071-29t29-71q0-42-29-71t-71-29q-42%200-71%2029t-29%2071q0%2042%2029%2071t71%2029Z'/%3e%3c/svg%3e";let E,M;async function re(){const e=be();i.map.setCenter(e),E||(E=await w(e,!1,"Random marker",oe)),$(E,e)}async function ie(){await x()}function ae(e,t){obj.infoWindow.setPosition(t),obj.infoWindow.setContent("Error: The Geolocation service failed."),obj.infoWindow.open(obj.map)}async function S(e){const t=e.position;let o=`<p>Pin dropped at: ${t.lat}, ${t.lng}</p>
  <button type="button" id="btn-add-to-route">Add to route</button>`,n=null;y(e,"",!0);try{const r=i.marker.position,a=await J(r,t);if(!a.routes||a.routes.length===0)o+="<b>No routes found</b>";else{const s=a.routes[0],{kkms:d,kms:u,meters:m}=_(s.distanceMeters),{days:p,hours:h,minutes:f}=H(Number.parseInt(s.duration));n=s.polyline?.encodedPolyline||null,o+=`<p>Approximate route length: ${d||""} ${u||""} km., ${m} meters</p>
  			<p>Approximate route time:
        ${p?p+" d.,":""}
        ${h?h+" h.,":""}
        ${f} min. </p>`,n?o+='<button id="btn-draw-route" type="button">Draw route</button>':o+="<b>No route polyline found</b>"}y(e,o),google.maps.event.addListenerOnce(i.infoWindow,"domready",()=>{const s=document.getElementById("btn-draw-route"),d=document.getElementById("btn-add-to-route");s&&d&&(s.addEventListener("click",()=>{n?X(n):console.error("Cannot draw route: No encoded polyline available.")}),d.addEventListener("click",he))})}catch(r){console.error("Error fetching route:",r),o+="<b>Error retrieving route data</b>",await x(),y(e,o)}}async function se(e){const t=e.latLng;Y(t)}function T(){const e=i.marker.position;y(i.marker,"",!0),b("user-location-marker",e),y(i.marker,"New your current location. Saved!")}async function ce(e){e.preventDefault();const t=e.target,o=t.elements["location-text"].value.trim();try{if(o){const n=await Le(o);n&&(z(n),c.closeLocationListBtn.removeAttribute("hidden"))}else throw new Error("Query Error")}catch(n){j.error({title:"Submit form error",position:"topRight",message:n})}t.elements["location-text"].value=""}async function le(e){const t=e.target.closest(".location-item");if(t){const o=JSON.parse(t.dataset?.location||"{}"),n=t.dataset?.name;o&&n?(i.map.setCenter(o),M||(M=await w(o,!1,n,ne,!1)),$(M,o)):console.warn("Missing data attributes on the clicked element.")}else console.warn("Invalid click: No valid list item found.")}function de(){c.closeLocationListBtn.setAttribute("hidden",!0),c.locationList.innerHTML=""}function ue(e){e.preventDefault();const t=L("user-location-marker"),n=e.target.elements["route-name"].value.trim();Q(t,n),P(l)}function me(e){const t=e.target.dataset.routeid;console.log(t)}function pe(e){const t=e.target.dataset.routeid;console.log(t)}function ge(e){const t=e.target.dataset.routeid,o=V(t);console.log(o)}function fe(e){const t=e.target.dataset.pointid,o=te(t);ke(o.coordinate),console.log(t)}function he(){K(l)}function ye(){c.dialog.close()}function we(e){e.preventDefault();const t=e.target,o=t.elements.route.value,n=t.elements["point-title"].value.trim(),r=t.elements["point-description"].value.trim();console.log(o,n,r)}async function ve(e={lat:-25.344,lng:131.031}){const{Map:t}=await google.maps.importLibrary("maps"),o=await new t(c.mapArea,{zoom:16,center:e,mapId:"DEMO_MAP_ID"});return o.addListener("click",n=>{se(n)}),console.log("Init Map"),o}async function x(){try{const e=await W();i.infoWindow.setPosition(e),i.infoWindow.setContent("Your current location"),i.infoWindow.open(i.map),i.marker.position=e,i.map.setCenter(e),i.map.setZoom(15)}catch{ae(!0,i.infoWindow,i.map.getCenter())}}async function W(){return new Promise((e,t)=>{if(!navigator.geolocation){reject(new Error("Geolocation is not supported by this browser."));return}navigator.geolocation.getCurrentPosition(o=>e({lat:o.coords.latitude,lng:o.coords.longitude}),o=>t(o),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})})}async function Le(e){const t=`https://maps.googleapis.com/maps/api/geocode/json?address=${e}&key=${I.GM_API_KEY}`;try{const{data:o}=await A(t);if(o.results&&o.results.length!==0)return o.results;throw new Error("Place not found!")}catch(o){iziToast.error({title:"Get location error!",position:"topRight",message:o})}}function be(){return{lat:Number(R(-64.05,85.05)),lng:Number(R(-180,180))}}function ke(e,t={}){i.map.setCenter(e),i.infoWindow.setPosition(e),t.length?i.infoWindow.setContent(t.title):i.infoWindow.setContent(`Poin coordinates: LAT:${e.lat}, LNG: ${e.lng}`),i.infoWindow.open(i.map)}const B=c.resizer.previousElementSibling;let q=!1;c.resizer.addEventListener("mousedown",e=>{q=!0,document.addEventListener("mousemove",D),document.addEventListener("mouseup",O)});function D(e){if(!q)return;let t=e.clientX-B.getBoundingClientRect().left;B.style.width=`${t}px`}function O(){q=!1,document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",O)}const Ee=document.querySelectorAll(".draggable"),Me=document.querySelectorAll(".draggable-container");Ee.forEach(e=>{e.addEventListener("dragstart",()=>{e.classList.add("dragging")}),e.addEventListener("dragend",()=>{e.classList.remove("dragging")})});Me.forEach(e=>{e.addEventListener("dragover",t=>{t.preventDefault();const o=document.querySelector(".dragging"),n=Ie(e,t.clientY);n?e.insertBefore(o,n):e.appendChild(o)})});function Ie(e,t){const o=[...e.querySelectorAll(".draggable:not(.dragging)")];for(const n of o){const r=n.getBoundingClientRect();if(t<r.bottom)return n}return null}const Pe="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20height='24px'%20viewBox='0%20-960%20960%20960'%20width='24px'%20fill='%23e3e3e3'%3e%3cpath%20d='M360-80v-529q-91-24-145.5-100.5T160-880h80q0%2083%2053.5%20141.5T430-680h100q30%200%2056%2011t47%2032l181%20181-56%2056-158-158v478h-80v-240h-80v240h-80Zm120-640q-33%200-56.5-23.5T400-800q0-33%2023.5-56.5T480-880q33%200%2056.5%2023.5T560-800q0%2033-23.5%2056.5T480-720Z'/%3e%3c/svg%3e";async function qe(){const{InfoWindow:e}=await google.maps.importLibrary("maps");return console.log("Init InfoWindow"),new e}async function Re(){console.log("Init App");const e=await W();i.map=await ve(e),i.marker=await w(e,!0,"Your location",Pe,!1),i.infoWindow=await qe(),Z(),ee(),i.marker.addListener("dragend",T),i.marker.addListener("gmp-click",T),c.randomBtn.addEventListener("click",re),c.findMeBtn.addEventListener("click",ie),c.addLocationForm.addEventListener("submit",ce),c.locationList.addEventListener("click",le),c.closeLocationListBtn.addEventListener("click",de),c.createRouteForm.addEventListener("submit",ue),c.dialog.addEventListener("submit",we),c.dialogCloseBtn.addEventListener("click",ye)}window.onload=Re;
//# sourceMappingURL=index.js.map
