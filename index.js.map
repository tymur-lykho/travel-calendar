{"version":3,"file":"index.js","sources":["../src/js/maps.js","../src/js/maps_init.js","../src/js/resizer.js","../src/js/routes.js","../src/js/utils.js","../src/main.js"],"sourcesContent":["const { Map } = await google.maps.importLibrary('maps');\nconst { AdvancedMarkerElement } = await google.maps.importLibrary('marker');\nconst { geometry } = await google.maps.importLibrary('geometry');\n\nlet map, infoWindow;\n\nexport async function initMap(position = { lat: -25.344, lng: 131.031 }) {\n  map = await new Map(document.getElementById('map'), {\n    zoom: 5,\n    center: position,\n    mapId: 'DEMO_MAP_ID',\n  });\n\n  const marker = initMarker(map, position, true, 'Draggable marker');\n\n  infoWindow = new google.maps.InfoWindow();\n\n  return { map, marker, infoWindow };\n}\n\nexport async function getMyGeolocation() {\n  try {\n    const pos = await getCurrentLocation();\n\n    infoWindow.setPosition(pos);\n    infoWindow.setContent('Location found.');\n    infoWindow.open(map);\n    map.setCenter(pos);\n  } catch (error) {\n    handleLocationError(true, infoWindow, map.getCenter());\n  }\n}\n\nexport async function getCurrentLocation() {\n  return new Promise((res, rej) => {\n    if (!navigator.geolocation) {\n      reject(new Error('Geolocation is not supported by this browser.'));\n      return;\n    }\n    navigator.geolocation.getCurrentPosition(\n      position =>\n        res({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        }),\n      e => rej(e),\n      {\n        enableHighAccuracy: true,\n        timeout: 5000,\n        maximumAge: 0,\n      }\n    );\n  });\n}\n\nexport async function drawRoute(map, encodedPolyline) {\n  const path = google.maps.geometry.encoding.decodePath(encodedPolyline);\n\n  const routePath = new google.maps.Polyline({\n    path: path,\n    geodesic: true,\n    strokeColor: '#FF0000',\n    strokeOpacity: 1.0,\n    strokeWeight: 4,\n  });\n\n  routePath.setMap(map);\n}\n\nexport function markerUpdate(marker, position) {\n  marker.position = position;\n}\n\nexport function getRandomPlace() {\n  return {\n    lat: Number(getRandomArbitrary(-85.05, 85.05)),\n    lng: Number(getRandomArbitrary(-180, 180)),\n  };\n}\n\nfunction initMarker(map, position, draggable, title) {\n  return new AdvancedMarkerElement({\n    map: map,\n    position: position,\n    gmpDraggable: draggable,\n    title: title,\n  });\n}\n\nfunction getRandomArbitrary(min, max) {\n  return Math.random() * (max - min) + min;\n}\n\nfunction handleLocationError(browserHasGeolocation, infoWindow, pos) {\n  infoWindow.setPosition(pos);\n  infoWindow.setContent(\n    browserHasGeolocation\n      ? 'Error: The Geolocation service failed.'\n      : \"Error: Your browser doesn't support geolocation.\"\n  );\n  infoWindow.open(map);\n}\n","(g => {\n  console.log(import.meta.env);\n  var h,\n    a,\n    k,\n    p = 'The Google Maps JavaScript API',\n    c = 'google',\n    l = 'importLibrary',\n    q = '__ib__',\n    m = document,\n    b = window;\n  b = b[c] || (b[c] = {});\n  var d = b.maps || (b.maps = {}),\n    r = new Set(),\n    e = new URLSearchParams(),\n    u = () =>\n      h ||\n      (h = new Promise(async (f, n) => {\n        await (a = m.createElement('script'));\n        e.set('libraries', [...r] + '');\n        for (k in g)\n          e.set(\n            k.replace(/[A-Z]/g, t => '_' + t[0].toLowerCase()),\n            g[k]\n          );\n        e.set('callback', c + '.maps.' + q);\n        a.src = `https://maps.${c}apis.com/maps/api/js?` + e;\n        d[q] = f;\n        a.onerror = () => (h = n(Error(p + ' could not load.')));\n        a.nonce = m.querySelector('script[nonce]')?.nonce || '';\n        m.head.append(a);\n      }));\n  d[l]\n    ? console.warn(p + ' only loads once. Ignoring:', g)\n    : (d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)));\n})({\n  key: import.meta.env.VITE_GOOGLE_MAP_API_KEY,\n  v: 'weekly',\n});\n","const resizer = document.querySelector('.resizer');\nconst leftColumn = resizer.previousElementSibling;\nconst rightColumn = resizer.nextElementSibling;\n\nlet isResizing = false;\n\nresizer.addEventListener('mousedown', event => {\n  isResizing = true;\n  document.addEventListener('mousemove', onMouseMove);\n  document.addEventListener('mouseup', onMouseUp);\n});\n\nfunction onMouseMove(event) {\n  if (!isResizing) return;\n\n  let newLeftWidth = event.clientX - leftColumn.getBoundingClientRect().left;\n  leftColumn.style.width = `${newLeftWidth}px`;\n}\n\nfunction onMouseUp() {\n  isResizing = false;\n  document.removeEventListener('mousemove', onMouseMove);\n  document.removeEventListener('mouseup', onMouseUp);\n}\n","import axios from 'axios';\n\nconst API_KEY = import.meta.env.VITE_GOOGLE_MAP_API_KEY;\n\nexport async function getRoutes(origin, destination) {\n  const url = 'https://routes.googleapis.com/directions/v2:computeRoutes';\n\n  const requestData = {\n    origin: {\n      location: {\n        latLng: {\n          latitude: origin.lat,\n          longitude: origin.lng,\n        },\n      },\n    },\n    destination: {\n      location: {\n        latLng: {\n          latitude: destination.lat,\n          longitude: destination.lng,\n        },\n      },\n    },\n    travelMode: 'WALK',\n    //routingPreference: 'TRAFFIC_UNAWARE',\n    computeAlternativeRoutes: false,\n    routeModifiers: {\n      avoidTolls: false,\n      avoidHighways: false,\n      avoidFerries: false,\n    },\n    languageCode: 'en-US',\n    units: 'IMPERIAL',\n  };\n\n  try {\n    const response = await axios.post(url, requestData, {\n      headers: {\n        'Content-Type': 'application/json',\n        'X-Goog-Api-Key': API_KEY,\n        'X-Goog-FieldMask':\n          'routes.duration,routes.distanceMeters,routes.polyline.encodedPolyline',\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error(\n      'Помилка отримання маршруту:',\n      error.response?.data || error.message\n    );\n    throw error;\n  }\n}\n","export function convertS(s) {\n  const minute = 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  const days = Math.floor(s / day);\n  const hours = Math.floor((s % day) / hour);\n  const minutes = Math.floor((s % hour) / minute);\n  const seconds = s % minute;\n\n  return { days, hours, minutes, seconds };\n}\n","import {\n  initMap,\n  getRandomPlace,\n  markerUpdate,\n  getMyGeolocation,\n  getCurrentLocation,\n  drawRoute,\n} from './js/maps';\nimport './js/resizer.js';\nimport { getRoutes } from './js/routes.js';\nimport { convertS } from './js/utils.js';\n\nconst randomBtn = document.getElementById('btn-random-place');\nconst findMeBtn = document.getElementById('btn-my-coordinate');\n// const getRoutesToPoint = document.getElementById('btn-get-routes-to-point');\n\nconst { map, marker, infoWindow } = await initMap();\n\nrandomBtn.addEventListener('click', async () => {\n  const newPosition = await getRandomPlace();\n  map.setCenter(newPosition);\n  markerUpdate(marker, newPosition);\n});\n\nfindMeBtn.addEventListener('click', async () => {\n  await getMyGeolocation();\n  map.setZoom(15);\n});\n\n// getRoutesToPoint.addEventListener('click', async () => {\n//   try {\n//     const originCoordinate = await getCurrentLocation();\n//     const destinationCoordinate = marker.position;\n//     getRoutes(originCoordinate, destinationCoordinate);\n//   } catch (error) {\n//     console.log(error);\n//   }\n// });\n\nmarker.addListener('dragend', async () => {\n  const position = marker.position;\n  let info = `<p>Pin dropped at: ${position.lat}, ${position.lng}</p>`;\n  let encodedPolyline = null;\n\n  try {\n    const originCoordinate = await getCurrentLocation();\n    const data = await getRoutes(originCoordinate, position);\n\n    if (!data.routes || data.routes.length === 0) {\n      info += '<b>No routes found</b>';\n    } else {\n      const route = data.routes[0];\n\n      const routeDistance =\n        route.distanceMeters > 1000\n          ? route.distanceMeters / 1000\n          : route.distanceMeters;\n\n      const { days, hours, minutes } = convertS(\n        Number.parseInt(route.duration)\n      );\n\n      encodedPolyline = route.polyline?.encodedPolyline || null;\n\n      info += `<p>Approximate route length: ${routeDistance} ${\n        routeDistance > 1000 ? 'km' : 'm'\n      }</p>\n      <p>Approximate route time: ${days} d., ${hours} h., ${minutes} min. </p>`;\n\n      if (encodedPolyline) {\n        info += `<button id=\"btn-draw-route\" type=\"button\">Draw route</button>`;\n      } else {\n        info += '<b>No route polyline found</b>';\n      }\n    }\n\n    infoWindow.close();\n    infoWindow.setContent(info);\n    infoWindow.open(marker.map, marker);\n\n    google.maps.event.addListenerOnce(infoWindow, 'domready', () => {\n      const btn = document.getElementById('btn-draw-route');\n      if (btn) {\n        btn.addEventListener('click', () => {\n          if (encodedPolyline) {\n            drawRoute(map, encodedPolyline);\n          } else {\n            console.error('Cannot draw route: No encoded polyline available.');\n          }\n        });\n      }\n    });\n  } catch (error) {\n    console.error('Error fetching route:', error);\n    info += '<b>Error retrieving route data</b>';\n    infoWindow.setContent(info);\n    infoWindow.open(marker.map, marker);\n  }\n});\n"],"names":["Map","AdvancedMarkerElement","map","infoWindow","initMap","position","marker","initMarker","getMyGeolocation","pos","getCurrentLocation","handleLocationError","res","rej","e","drawRoute","encodedPolyline","path","markerUpdate","getRandomPlace","getRandomArbitrary","draggable","title","min","max","browserHasGeolocation","g","__vite_import_meta_env__","h","a","k","p","c","l","q","m","b","d","r","u","f","n","t","resizer","leftColumn","isResizing","event","onMouseMove","onMouseUp","newLeftWidth","API_KEY","getRoutes","origin","destination","url","requestData","axios","error","convertS","s","days","hours","minutes","seconds","randomBtn","findMeBtn","newPosition","info","originCoordinate","data","route","routeDistance","btn"],"mappings":"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"}