{"version":3,"file":"index.js","sources":["../src/js/config.js","../src/js/maps_init.js","../src/js/maps.js","../src/js/resizer.js","../src/js/routes.js","../src/js/utils.js","../src/main.js"],"sourcesContent":["export const config = {\n  GM_API_KEY: import.meta.env.VITE_GOOGLE_MAP_API_KEY,\n};\n","import { config } from './config';\n\nconsole.log(config.GM_API_KEY);\n\n(g => {\n  var h,\n    a,\n    k,\n    p = 'The Google Maps JavaScript API',\n    c = 'google',\n    l = 'importLibrary',\n    q = '__ib__',\n    m = document,\n    b = window;\n  b = b[c] || (b[c] = {});\n  var d = b.maps || (b.maps = {}),\n    r = new Set(),\n    e = new URLSearchParams(),\n    u = () =>\n      h ||\n      (h = new Promise(async (f, n) => {\n        await (a = m.createElement('script'));\n        e.set('libraries', [...r] + '');\n        for (k in g)\n          e.set(\n            k.replace(/[A-Z]/g, t => '_' + t[0].toLowerCase()),\n            g[k]\n          );\n        e.set('callback', c + '.maps.' + q);\n        a.src = `https://maps.${c}apis.com/maps/api/js?` + e;\n        d[q] = f;\n        a.onerror = () => (h = n(Error(p + ' could not load.')));\n        a.nonce = m.querySelector('script[nonce]')?.nonce || '';\n        m.head.append(a);\n      }));\n  d[l]\n    ? console.warn(p + ' only loads once. Ignoring:', g)\n    : (d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)));\n})({\n  key: config.GM_API_KEY,\n  v: 'weekly',\n});\n","let map, marker, infoWindow;\n\nexport async function initMap(position = { lat: -25.344, lng: 131.031 }) {\n  const { Map } = await google.maps.importLibrary('maps');\n  map = await new Map(document.getElementById('map'), {\n    zoom: 5,\n    center: position,\n    mapId: 'DEMO_MAP_ID',\n  });\n\n  marker = await initMarker(map, position, true, 'Draggable marker');\n\n  infoWindow = new google.maps.InfoWindow();\n\n  return { map, marker, infoWindow };\n}\n\nexport async function getMyGeolocation() {\n  try {\n    const pos = await getCurrentLocation();\n\n    infoWindow.setPosition(pos);\n    infoWindow.setContent('Location found.');\n    infoWindow.open(map);\n    map.setCenter(pos);\n  } catch (error) {\n    handleLocationError(true, infoWindow, map.getCenter());\n  }\n}\n\nexport async function getCurrentLocation() {\n  return new Promise((res, rej) => {\n    if (!navigator.geolocation) {\n      reject(new Error('Geolocation is not supported by this browser.'));\n      return;\n    }\n    navigator.geolocation.getCurrentPosition(\n      position =>\n        res({\n          lat: position.coords.latitude,\n          lng: position.coords.longitude,\n        }),\n      e => rej(e),\n      {\n        enableHighAccuracy: true,\n        timeout: 5000,\n        maximumAge: 0,\n      }\n    );\n  });\n}\n\nexport async function drawRoute(map, encodedPolyline) {\n  const { geometry } = await google.maps.importLibrary('geometry');\n\n  const path = google.maps.geometry.encoding.decodePath(encodedPolyline);\n\n  const routePath = new google.maps.Polyline({\n    path: path,\n    geodesic: true,\n    strokeColor: '#FF0000',\n    strokeOpacity: 1.0,\n    strokeWeight: 4,\n  });\n\n  routePath.setMap(map);\n}\n\nexport function markerUpdate(marker, position) {\n  marker.position = position;\n}\n\nexport function getRandomPlace() {\n  return {\n    lat: Number(getRandomArbitrary(-85.05, 85.05)),\n    lng: Number(getRandomArbitrary(-180, 180)),\n  };\n}\n\nasync function initMarker(map, position, draggable, title) {\n  const { AdvancedMarkerElement } = await google.maps.importLibrary('marker');\n\n  return new AdvancedMarkerElement({\n    map: map,\n    position: position,\n    gmpDraggable: draggable,\n    title: title,\n  });\n}\n\nfunction getRandomArbitrary(min, max) {\n  return Math.random() * (max - min) + min;\n}\n\nfunction handleLocationError(browserHasGeolocation, infoWindow, pos) {\n  infoWindow.setPosition(pos);\n  infoWindow.setContent(\n    browserHasGeolocation\n      ? 'Error: The Geolocation service failed.'\n      : \"Error: Your browser doesn't support geolocation.\"\n  );\n  infoWindow.open(map);\n}\n\nexport function redrawMarkerWindow(marker, markup) {\n  infoWindow.close();\n  infoWindow.setContent(markup);\n  infoWindow.open(marker.map, marker);\n}\n","const resizer = document.querySelector('.resizer');\nconst leftColumn = resizer.previousElementSibling;\nconst rightColumn = resizer.nextElementSibling;\n\nlet isResizing = false;\n\nresizer.addEventListener('mousedown', event => {\n  isResizing = true;\n  document.addEventListener('mousemove', onMouseMove);\n  document.addEventListener('mouseup', onMouseUp);\n});\n\nfunction onMouseMove(event) {\n  if (!isResizing) return;\n\n  let newLeftWidth = event.clientX - leftColumn.getBoundingClientRect().left;\n  leftColumn.style.width = `${newLeftWidth}px`;\n}\n\nfunction onMouseUp() {\n  isResizing = false;\n  document.removeEventListener('mousemove', onMouseMove);\n  document.removeEventListener('mouseup', onMouseUp);\n}\n","import axios from 'axios';\nimport { config } from './config';\n\nexport async function getRoutes(origin, destination) {\n  const url = 'https://routes.googleapis.com/directions/v2:computeRoutes';\n\n  const requestData = {\n    origin: {\n      location: {\n        latLng: {\n          latitude: origin.lat,\n          longitude: origin.lng,\n        },\n      },\n    },\n    destination: {\n      location: {\n        latLng: {\n          latitude: destination.lat,\n          longitude: destination.lng,\n        },\n      },\n    },\n    travelMode: 'WALK',\n    //routingPreference: 'TRAFFIC_UNAWARE',\n    computeAlternativeRoutes: false,\n    routeModifiers: {\n      avoidTolls: false,\n      avoidHighways: false,\n      avoidFerries: false,\n    },\n    languageCode: 'en-US',\n    units: 'IMPERIAL',\n  };\n\n  try {\n    const response = await axios.post(url, requestData, {\n      headers: {\n        'Content-Type': 'application/json',\n        'X-Goog-Api-Key': config.GM_API_KEY,\n        'X-Goog-FieldMask':\n          'routes.duration,routes.distanceMeters,routes.polyline.encodedPolyline',\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error(\n      'Помилка отримання маршруту:',\n      error.response?.data || error.message\n    );\n    throw error;\n  }\n}\n","export function convertS(s) {\n  const minute = 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n\n  const days = Math.floor(s / day);\n  const hours = Math.floor((s % day) / hour);\n  const minutes = Math.floor((s % hour) / minute);\n  const seconds = s % minute;\n\n  return { days, hours, minutes, seconds };\n}\n","import {\n  initMap,\n  getRandomPlace,\n  markerUpdate,\n  getMyGeolocation,\n  getCurrentLocation,\n  drawRoute,\n  redrawMarkerWindow,\n} from './js/maps';\nimport './js/resizer.js';\nimport { getRoutes } from './js/routes.js';\nimport { convertS } from './js/utils.js';\n\nconst randomBtn = document.getElementById('btn-random-place');\nconst findMeBtn = document.getElementById('btn-my-coordinate');\n// const getRoutesToPoint = document.getElementById('btn-get-routes-to-point');\n\nconst { map, marker, infoWindow } = await initMap();\n\nrandomBtn.addEventListener('click', async () => {\n  const newPosition = await getRandomPlace();\n  map.setCenter(newPosition);\n  markerUpdate(marker, newPosition);\n});\n\nfindMeBtn.addEventListener('click', async () => {\n  await getMyGeolocation();\n  map.setZoom(15);\n});\n\n// getRoutesToPoint.addEventListener('click', async () => {\n//   try {\n//     const originCoordinate = await getCurrentLocation();\n//     const destinationCoordinate = marker.position;\n//     getRoutes(originCoordinate, destinationCoordinate);\n//   } catch (error) {\n//     console.log(error);\n//   }\n// });\n\nmarker.addListener('dragstart', () => {\n  infoWindow.close();\n});\n\nmarker.addListener('dragend', async () => {\n  const position = marker.position;\n  let info = `<p>Pin dropped at: ${position.lat}, ${position.lng}</p>`;\n  let encodedPolyline = null;\n\n  redrawMarkerWindow(marker, '<div class=\"loader\"></div>');\n\n  try {\n    const originCoordinate = await getCurrentLocation();\n    const data = await getRoutes(originCoordinate, position);\n\n    if (!data.routes || data.routes.length === 0) {\n      info += '<b>No routes found</b>';\n      redrawMarkerWindow(marker, info);\n    } else {\n      const route = data.routes[0];\n\n      const routeDistance =\n        route.distanceMeters > 1000\n          ? route.distanceMeters / 1000\n          : route.distanceMeters;\n\n      const { days, hours, minutes } = convertS(\n        Number.parseInt(route.duration)\n      );\n\n      encodedPolyline = route.polyline?.encodedPolyline || null;\n\n      info += `<p>Approximate route length: ${routeDistance} ${\n        routeDistance > 1000 ? 'km' : 'm'\n      }</p>\n      <p>Approximate route time: ${days} d., ${hours} h., ${minutes} min. </p>`;\n\n      if (encodedPolyline) {\n        info += `<button id=\"btn-draw-route\" type=\"button\">Draw route</button>`;\n      } else {\n        info += '<b>No route polyline found</b>';\n      }\n    }\n\n    redrawMarkerWindow(marker, info);\n\n    google.maps.event.addListenerOnce(infoWindow, 'domready', () => {\n      const btn = document.getElementById('btn-draw-route');\n      if (btn) {\n        btn.addEventListener('click', () => {\n          if (encodedPolyline) {\n            drawRoute(map, encodedPolyline);\n          } else {\n            console.error('Cannot draw route: No encoded polyline available.');\n          }\n        });\n      }\n    });\n  } catch (error) {\n    console.error('Error fetching route:', error);\n    info += '<b>Error retrieving route data</b>';\n    await getMyGeolocation();\n    redrawMarkerWindow(marker, info);\n  }\n});\n"],"names":["config","g","h","a","k","p","c","l","q","b","d","r","e","u","n","t","map","marker","infoWindow","initMap","position","Map","initMarker","getMyGeolocation","pos","getCurrentLocation","handleLocationError","res","rej","drawRoute","encodedPolyline","path","markerUpdate","getRandomPlace","getRandomArbitrary","draggable","title","AdvancedMarkerElement","min","max","browserHasGeolocation","redrawMarkerWindow","markup","resizer","leftColumn","isResizing","event","onMouseMove","onMouseUp","newLeftWidth","getRoutes","origin","destination","url","requestData","axios","error","convertS","s","days","hours","minutes","seconds","randomBtn","findMeBtn","newPosition","info","originCoordinate","data","route","routeDistance","btn"],"mappings":"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"}